<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook51-profile.xsl"
 type="text/xml"
 title="Profiling step"?>
<!DOCTYPE chapter
[
  <!ENTITY % entities SYSTEM "generic-entities.ent">
    %entities;
]>

<chapter xml:id="cha-ha-installation-overview" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.1"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink">
  <title>Installation overview</title>
  <info>
    <abstract>
      <para>
        This chapter shows an overview of the steps required to set up a working and supported
        &ha; cluster. The steps in this guide include all of the available options for cluster
        installation. To set up a basic two-node cluster with only the default options,
        see <xref linkend="article-installation"/>.
      </para>
    </abstract>
    <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
      <dm:bugtracker></dm:bugtracker>
      <dm:translation>yes</dm:translation>
    </dm:docmanager>
  </info>
  <procedure xml:id="pro-ha-installation-overview">
    <title>Overview of installing a &ha; cluster</title>
    <step>
      <para>
        Review <xref linkend="cha-ha-requirements"/> to make sure your nodes and other
        infrastructure meet the requirements for a &ha; cluster.
      </para>
    </step>
    <step>
      <para>
        You can set up the cluster with the &rootuser; user or a user with
        <command>sudo</command> privileges. Review <xref linkend="cha-ha-log-in"/>
        to choose the right user for your requirements.
      </para>
    </step>
    <step>
      <para>
        Install the &ha; extension and packages on the nodes as described in
        <xref linkend="cha-ha-install"/>.
      </para>
    </step>
    <step performance="optional">
      <para>
        To configure SBD (&stonith; Block Device) using the bootstrap scripts, you must set up a
        watchdog on each node <emphasis>before</emphasis> you initialize the cluster. SBD is a
        node fencing mechanism that can be used either with shared storage or in diskless mode.
        For more information about SBD, see <xref linkend="cha-ha-storage-protect"/>.
        To configure the watchdog, see <xref linkend="sec-ha-storage-protect-watchdog"/>.
      </para>
      <para>
        Alternatively, you can configure SBD <emphasis>after</emphasis> setting up the cluster,
        or use physical fencing devices instead.
      </para>
    </step>
    <step>
      <para>
        Set up the cluster on the nodes. You can use either of the following methods:
      </para>
      <itemizedlist>
        <listitem>
          <para>
            <xref linkend="cha-ha-bootstrap-install"/>
          </para>
        </listitem>
        <listitem>
          <para>
            <xref linkend="cha-ha-ycluster"/>
          </para>
        </listitem>
      </itemizedlist>
      <para>
        <xref linkend="tab-ha-installation-overview"/> shows the components that can be
        configured by each method. You can also use a combination of methods.
        For example, you could set up one node with &yast;, then use
        the bootstrap scripts to add more nodes.
      </para>
    </step>
    <step>
      <para>
        Add more nodes. You can use the bootstrap scripts or the &yast; cluster module,
        or you can clone nodes for mass deployment as described in
        <xref linkend="sec-ha-installation-autoyast"/>.
      </para>
    </step>
    <step>
      <para>
        To be supported, a &sleha; cluster <emphasis>must</emphasis> have &stonith; (node fencing)
        enabled. A node fencing mechanism can be one of the following:
      </para>
      <itemizedlist>
        <listitem>
          <para>
            A physical device (a power switch). Each node must have at least
            one device. We strongly recommend having multiple &stonith; devices per node.
            To configure the cluster to use physical &stonith; devices, see
            <xref linkend="cha-ha-fencing"/>.
          </para>
        </listitem>
        <listitem>
          <para>
            SBD (&stonith; Block Device) in combination with a watchdog. SBD can be used
            either with shared storage or in diskless mode. Diskless SBD should only be
            used in clusters with more than two nodes. For disk-based SBD, we strongly
            recommend having multiple SBD devices per cluster. To configure SBD and the
            watchdog, see <xref linkend="cha-ha-storage-protect"/>.
          </para>
        </listitem>
      </itemizedlist>
    </step>
    <step>
      <para>
        Continue to <xref linkend="part-config"/> and <xref linkend="part-storage"/> to
        set up cluster resources, data replication, and other components as needed.
      </para>
    </step>
  </procedure>

  <table pgwide="1" xml:id="tab-ha-installation-overview">
    <title>&ha; cluster components: setup methods</title>
    <tgroup cols="3">
    <colspec colname="c1" colwidth="33%"/>
    <colspec colname="c2" colwidth="33%"/>
    <colspec colname="c3" colwidth="34%"/>
      <thead>
        <row>
          <entry>Component</entry>
          <entry>Bootstrap scripts</entry>
          <entry>&yast; cluster module</entry>
        </row>
      </thead>
      <tbody>
        <row>
          <entry>Authentication settings</entry>
          <entry>Yes</entry>
          <entry>Yes</entry>
        </row>
        <row>
          <entry>Cluster name</entry>
          <entry>Yes</entry>
          <entry>Yes</entry>
        </row>
        <row>
          <entry>Conntrack tools</entry>
          <entry>No</entry>
          <entry>Yes</entry>
        </row>
        <row>
          <entry>&corosync;</entry>
          <entry>Yes</entry>
          <entry>Yes</entry>
        </row>
        <row>
          <entry>&csync;</entry>
          <entry>Yes</entry>
          <entry>Yes</entry>
        </row>
        <row>
          <entry>Firewall ports</entry>
          <entry>Yes</entry>
          <entry>Yes</entry>
        </row>
        <row>
          <entry>&hawk2;</entry>
          <entry>Yes</entry>
          <entry>No</entry>
        </row>
        <row>
          <entry>Passwordless SSH</entry>
          <entry>Yes</entry>
          <entry>No; configure before setup</entry>
        </row>
        <row>
          <entry>&qdevice;</entry>
          <entry>Optional</entry>
          <entry>Optional</entry>
        </row>
        <row>
          <entry>&stonith; (node fencing)</entry>
          <entry>Optional (SBD only)</entry>
          <entry>No; configure after setup</entry>
        </row>
        <row>
          <entry>&stonith; timeout settings</entry>
          <entry>Yes, if SBD is configured</entry>
          <entry>No; configure after setup</entry>
        </row>
        <row>
          <entry>Virtual IP address for &hawk2;</entry>
          <entry>Yes</entry>
          <entry>No</entry>
        </row>
      </tbody>
    </tgroup>
  </table>
</chapter>
