<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ha_hawk2_manage_i.xml" version="5.0" xml:id="sec.conf.hawk2.manage">
 <title>管理叢集資源</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:maintainer/>
   <dm:status>編輯</dm:status>
   <dm:deadline/>
   <dm:priority/>
   <dm:translation>yes</dm:translation>
   <dm:languages/>
   <dm:release/>
   <dm:repository/>
  </dm:docmanager>
 </info>

 <para>
  除了設定叢集資源以外，Hawk2 還可用於從<guimenu>狀態</guimenu>螢幕管理現有資源。若要瞭解螢幕概觀，請參見<xref linkend="sec.conf.hawk2.manage.monitor.status"/>。
 </para>

 <sect2 xml:id="sec.conf.hawk2.manage.edit">
  <title>編輯資源和群組</title>
  <para>
   如果您需要編輯現有資源，請轉到<guimenu>狀態</guimenu>螢幕。在<guimenu>操作</guimenu>欄中，按一下要修改的資源或群組旁邊的向下箭頭圖示，然後選取<guimenu>編輯</guimenu>。
  </para>
  <para>
   編輯螢幕即會顯示。如果要編輯基本資源，則以下操作可用︰
  </para>
  <itemizedlist>
   <title>針對基本資源的操作</title>
   <listitem>
    <para>
     複製資源。
    </para>
   </listitem>
   <listitem>
    <para>
     重新命名資源 (變更其 ID)。
    </para>
   </listitem>
   <listitem>
    <para>
     刪除資源。
    </para>
   </listitem>
  </itemizedlist>
  <para>
   如果要編輯群組，則以下操作可用︰
  </para>
  <itemizedlist>
   <title>針對群組的操作</title>
   <listitem>
    <para>
     建立將新增至此群組的新基本資源。
    </para>
   </listitem>
   <listitem>
    <para>
     重新命名群組 (變更其 ID)。
    </para>
   </listitem>
   <listitem>
    <para>
     使用右側的<quote>把手</quote>圖示按目標順序拖放群組成員，即可為其重新排序。
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2 xml:id="sec.conf.hawk2.manage.start">
  <title>啟動資源</title>
  <para>
   啟動叢集資源之前，請先確定該資源已正確設定。例如，如果使用 Apache 伺服器做為叢集資源，請先設定 Apache 伺服器。完成 Apache 組態後再在叢集中啟動相應資源。
  </para>
  <note>
   <title>不要對叢集管理的服務執行任何操作</title>
   <para>
    當您正透過 High Availability Extension 管理某個資源時，就不能再啟動或停止該資源 (例如，不能在叢集之外手動啟動或停止，或者在開機或重新開機時啟動或停止)。High Availability Extension 軟體負責所有服務的啟動或停止動作。
   </para>
   <para>
    不過，如果您要檢查服務是否正確設定，請手動將其啟動，但務必在 High Availability Extension 接管之前將它再次停止。
   </para>
   <para>
    若要對目前由叢集管理的資源進行干預，請先將資源設定為<literal>維護模式</literal>。如需詳細資料，請參閱<xref linkend="pro.ha.maint.mode.rsc.hawk2"/>。
   </para>
  </note>
  <para>
   透過 Hawk2 建立資源時，您可以使用 <literal>target-role</literal> 中繼屬性設定該資源的初始狀態。如果將其值設定為 <literal>stopped</literal>，則資源建立後不會自動啟動。
  </para>
  <procedure xml:id="pro.hawk2.rsc.start">
   <title>啟動新資源</title>
   <step>
    <para>
     登入 Hawk2︰
    </para>
<screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
   </step>
   <step>
    <para>
     在左側導覽列中選取<guimenu>狀態</guimenu>。<guimenu>資源</guimenu>清單還會顯示<guimenu>狀態</guimenu>。
    </para>
   </step>
   <step>
    <para>
     選取要啟動的資源。在其<guimenu>操作</guimenu>欄中，按一下<guimenu>啟動</guimenu>圖示。若要繼續，請確認顯示的訊息。
    </para>
    <para>
     資源啟動後，Hawk2 會將資源的<guimenu>狀態</guimenu>變為綠色，並顯示目前執行該資源的節點。
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 xml:id="sec.conf.hawk2.manage.cleanup">
  <title>清理資源</title>
  <para>
   如果資源失敗，系統會自動將其重新啟動，但每次失敗都會增加該資源的 failcount。
  </para>
  <para>
   如果為資源設定了 <literal>migration-threshold</literal>，則當失敗次數達到移轉限定值時，節點將不再執行該資源。
  </para>
  <para>
   資源的 failcount 可自動重設 (若為資源設定 <literal>failure-timeout</literal> 選項)，也可按如下方式手動重設。
  </para>
  <procedure xml:id="pro.hawk2.clean">
   <title>清理資源</title>
   <step>
    <para>
     登入 Hawk2︰
    </para>
<screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
   </step>
   <step>
    <para>
     在左側導覽列中選取<guimenu>狀態</guimenu>。<guimenu>資源</guimenu>清單還會顯示<guimenu>狀態</guimenu>。
    </para>
   </step>
   <step>
    <para>
     轉到資源，進行清理。在<guimenu>操作</guimenu>欄中按一下向下箭頭按鈕，然後選取<guimenu>清理</guimenu>。若要繼續，請確認顯示的訊息。
    </para>
    <para>
     系統會執行指令 <command>crm resource cleanup</command> 並清理所有節點上的資源。
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 xml:id="sec.conf.hawk2.manage.remove">
  <title>移除叢集資源</title>
  <para>
   如果需要從叢集移除資源，請按照下面的程序操作，以免出現組態錯誤︰
  </para>
  <procedure xml:id="pro.hawk2.rsc.rm">
   <title>移除叢集資源</title>
   <step>
    <para>
     登入 Hawk2︰
    </para>
<screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
   </step>
   <step>
    <para>
     依照<xref linkend="pro.hawk2.clean"/> 中的說明在所有節點上清理該資源。
    </para>
   </step>
   <step>
    <para>
     停止資源︰
    </para>
    <substeps>
     <step>
      <para>
       在左側導覽列中選取<guimenu>狀態</guimenu>。<guimenu>資源</guimenu>清單還會顯示<guimenu>狀態</guimenu>。
      </para>
     </step>
     <step>
      <para>
       在<guimenu>操作</guimenu>欄中按一下資源旁邊的<guimenu>停止</guimenu>按鈕。
      </para>
     </step>
     <step>
      <para>
       若要繼續，請確認顯示的訊息。
      </para>
      <para>
       資源停止後，<guimenu>狀態</guimenu>欄將會反映此變化。
      </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     刪除資源︰
    </para>
    <substeps>
     <step>
      <para>
       在左側導覽列中選取<guimenu>編輯組態</guimenu>。
      </para>
     </step>
     <step>
      <para>
       在<guimenu>資源</guimenu>清單中前往相應的資源。在<guimenu>操作</guimenu>欄中按一下資源旁邊的<guimenu>刪除</guimenu>按鈕。
      </para>
     </step>
     <step>
      <para>
       若要繼續，請確認顯示的訊息。
      </para>
     </step>
    </substeps>
   </step>
  </procedure>
 </sect2>

 <sect2 xml:id="sec.conf.hawk2.manage.migrate">
  <title>移轉叢集資源</title>
  <para>
   如<xref linkend="sec.conf.hawk2.failover"/> 所述，當軟體或硬體發生故障時，叢集會自動對資源進行容錯移轉 (移轉)，具體情況視您可以定義的特定參數 (例如移轉限定值或資源粘性) 而定。除此之外，您也可以手動將資源移轉至叢集中的其他節點。或者，您決定將資源移出目前節點，然後讓叢集決定移入的目標位置。
  </para>
  <procedure xml:id="pro.hawk2.rsc.migrate">
   <title>手動移轉資源</title>
   <step>
    <para>
     登入 Hawk2︰
    </para>
<screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
   </step>
   <step>
    <para>
     在左側導覽列中選取<guimenu>狀態</guimenu>。<guimenu>資源</guimenu>清單還會顯示<guimenu>狀態</guimenu>。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>資源</guimenu>清單中選取相應的資源。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>操作</guimenu>欄中按一下向下箭頭按鈕，然後選取<guimenu>移轉</guimenu>。
    </para>
   </step>
   <step>
    <para>
     隨後開啟的視窗中會提供以下選項︰
    </para>
    <itemizedlist>
     <listitem>
      <para>
       <guimenu>從目前節點移開</guimenu>︰此選項會為目前節點建立一個分數為 <literal>-INFINITY</literal> 的位置條件約束。
      </para>
     </listitem>
     <listitem>
      <para>
       或者，您也可以將資源移到另一節點上。如此會建立一個位置條件約束，其目的節點的分數為 <literal>INFINITY</literal>。
      </para>
     </listitem>
    </itemizedlist>
   </step>
   <step>
    <para>
     確認您的選擇。
    </para>
   </step>
  </procedure>
  <para>
   若要讓資源回到原來的狀態，請執行下列步驟︰
  </para>
  <procedure xml:id="pro.hawk2.rsc.migrate.back">
   <title>取消移轉資源</title>
   <step>
    <para>
     登入 Hawk2︰
    </para>
<screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
   </step>
   <step>
    <para>
     在左側導覽列中選取<guimenu>狀態</guimenu>。<guimenu>資源</guimenu>清單還會顯示<guimenu>狀態</guimenu>。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>資源</guimenu>清單中前往相應的資源。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>操作</guimenu>欄中按一下向下箭頭按鈕，然後選取<guimenu>取消移轉</guimenu>。若要繼續，請確認顯示的訊息。
    </para>
    <para>
     Hawk2 會使用 <command>crm_resource </command> <option>-U</option> 指令。資源可以移回其原始位置，也可以保留在目前的位置 (具體取決於資源粘性)。
    </para>
   </step>
  </procedure>
  <para>
   如需詳細資訊，請參閱 <link xlink:href="http://www.clusterlabs.org/doc/"/> 上的<citetitle>《Pacemaker Explained》</citetitle>(Pacemaker 說明)。可參閱其中的「Resource Migration」(資源移轉) 一節。<citetitle/>
  </para>
 </sect2>
</sect1>
