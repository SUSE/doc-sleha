<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ha_install.xml" version="5.0" xml:id="cha.ha.install">
<?dbfo-need height="20em"?>


 <title>安裝 High Availability Extension</title>
 <info>
  <abstract>
   <para>如果您是首次使用 <phrase role="roductnamereg"><phrase os="sles">SUSE® Linux Enterprise High Availability Extension</phrase></phrase> 來設定高可用性叢集，最簡單的方法就是從基本的雙節點叢集開始。您也可以使用雙節點叢集來執行一些測試。之後，您便可使用 AutoYaST 複製現有的叢集節點來新增更多節點。複製的節點上會安裝相同的套件，並具有與原始節點相同的系統組態。
   </para>
   <para>
    如果要升級執行較低版 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> 的現有叢集，請參閱<xref linkend="cha.ha.migration"/>。
   </para>
  </abstract>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:maintainer/>
   <dm:status>編輯</dm:status>
   <dm:deadline/>
   <dm:priority/>
   <dm:translation>yes</dm:translation>
   <dm:languages/>
   <dm:release/>
   <dm:repository/>
  </dm:docmanager>
 </info>
 
 <sect1 xml:id="sec.ha.install.manual">
  <title>手動安裝</title>
  <para> 《<citetitle>安裝與設定快速入門</citetitle>》中介紹了如何手動安裝 High Availability Extension 的套件。該指南會引導您完成基本雙節點叢集的設定。請參閱 <link xlink:href="https://www.suse.com/documentation/"/>。
  </para>
 </sect1>
  <sect1 xml:id="sec.ha.installation.autoyast">
  <title>使用 AutoYaST 進行批量安裝和部署</title>

  <para>
   安裝並設定雙節點叢集後，您可以使用 AutoYaST 複製現有節點並將複製品新增至叢集，以便擴充叢集。
  </para>
   
   <para>AutoYaST 使用包含安裝和組態資料的設定檔。設定檔會告訴 AutoYaST 要安裝什麼，及如何設定安裝的系統，以便最終部署一個即用系統。之後，可以採用多種方式使用此設定檔進行大規模部署 (例如，複製現存叢集節點)。</para>

   <para>
    如需如何在不同情況下使用 AutoYaST 的詳細指示，請參閱 <link xlink:href="http://www.suse.com/documentation/sle-12"/> 上的《<citetitle>SUSE Linux Enterprise <phrase role="productnumber"><phrase os="sles">12 SP3</phrase></phrase> 部署指南</citetitle>》。詳情位於「<citetitle>自動安裝</citetitle>」一章。
   </para>

   <important>
    <title>完全一樣的硬體</title>
    <para>
     <xref linkend="pro.ha.installation.clone.node"/>假設您要將 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> <phrase role="productnumber"><phrase os="sles"> 12 SP3</phrase></phrase> 部署到硬體組態完全一樣的一組機器上。
    </para>
    <para>
     如果您需要在組態不同的硬體上部署叢集節點，請參閱《<citetitle>SUSE Linux Enterprise <phrase role="productnumber"><phrase os="sles">12 SP3</phrase></phrase> 部署指南</citetitle>》「<citetitle>自動安裝</citetitle>」一章中的「<citetitle>基於規則的自動安裝</citetitle>」一節。
    </para>
   </important>



  <procedure xml:id="pro.ha.installation.clone.node">
   <title>使用 AutoYaST 複製叢集節點</title>
   <step>
    <para>
     確定已正確安裝並設定要複製的節點。如需詳細資料，請參閱《<citetitle><phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> 安裝與設定快速入門</citetitle>》或<xref linkend="cha.ha.setup"/>。
    </para>
   </step>
   <step>
    <para>
     依照《<citetitle>SUSE Linux Enterprise <phrase role="productnumber"><phrase os="sles">12 SP3</phrase></phrase> 部署指南</citetitle>》中的概要描述，進行簡單的大規模部署。基本步驟包括以下幾項︰
    </para>
    <substeps performance="required">
     <step>
      <para>
       建立 AutoYaST 設定檔。請使用 AutoYaST GUI 在現存系統組態的基礎上建立一個設定檔並加以修改。在 AutoYaST 中，選擇<guimenu>High Availability</guimenu>模組，然後按一下<guimenu>複製</guimenu>按鈕。如有需要，調整其他模組中的組態，並將產生的控制檔案儲存為 XML 檔案。
      </para>

      <para>
       如果您已設定 DRBD，也可以在 AutoYaST GUI 中選取並複製此模組。
      </para>
     </step>
     <step>
      <para>
       指定 AutoYaST 設定檔的來源，以及要傳遞給其他節點的安裝常式的參數。
      </para>
     </step>
     <step>
      <para>
       指定 SUSE Linux Enterprise Server 與 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> 安裝資料的來源。
      </para>
     </step>
     <step>
      <para>
       指定及設定自動安裝的開機程序。
      </para>
     </step>
     <step>
      <para>
       透過手動新增參數或建立 <filename>info</filename> 檔案的方式，將指令行傳遞給安裝常式。
      </para>
     </step>
     <step>
      <para>
       啟動和監控自動安裝程序。
      </para>
     </step>
    </substeps>
   </step>
  </procedure>

  <para>
   成功安裝副本後，請執行以下步驟將複製的節點加入叢集︰
  </para>

  <procedure xml:id="pro.ha.installation.clone.start">
   <title>連接複製的節點</title>
   <step>
    <para>
     依照<xref linkend="sec.ha.installation.setup.csync2"/> 所述使用 Csync2 將金鑰組態檔案從設定的節點傳輸到複製的節點。
    </para>
   </step>
   <step>
    <para>
     若要使節點上線，請依照<xref linkend="sec.ha.installation.start"/>所述在複製的節點上啟動 Pacemaker 服務。
    </para>
   </step>
  </procedure>

  <para>
   複製的節點現在將加入叢集，因為 <filename>/etc/corosync/corosync.conf</filename> 檔案已透過 Csync2 套用至複製的節點。CIB 會自動在叢集節點間同步。
  </para>
 </sect1>
</chapter>
