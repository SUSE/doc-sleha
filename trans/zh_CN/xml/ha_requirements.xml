<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<chapter xml:base="ha_requirements.xml" id="cha.ha.requirements">
 <title>系统要求和建议</title>
 <abstract>
  <para>
   下面的小节说明了系统要求以及 <phrase role="productnamereg"><phrase os="sles">SUSE® Linux Enterprise High Availability Extension</phrase></phrase> 的一些先决条件。此外，还提供了有关群集设置的建议。
  </para>
 </abstract>
 <sect1 id="sec.ha.requirements.hw">
  <title>硬件要求</title>

  <para>
   以下列表指出了基于 <phrase role="productnamereg"><phrase os="sles">SUSE® Linux Enterprise High Availability Extension</phrase></phrase> 的群集的硬件要求。这些要求表示最低硬件配置。根据群集的用途，可能会需要其他硬件。
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     安装了<xref linkend="sec.ha.requirements.sw"/>中指定的软件的 1 到 32 台 Linux 服务器。服务器不要求有相同的硬件（内存、磁盘空间等），但它们必须具有相同的体系结构。不支持跨平台群集。
    </para>
   </listitem>
   <listitem>
    <para> 每个群集节点至少有两个 TCP/IP 通讯媒体。群集节点使用多路广播或单路广播进行通讯，因此网络设备必须能支持您采用的通讯方式。通讯媒体应支持 100 Mbit/s 或更高的数据传送速度。最好应绑定以太网通道 </para>
   </listitem>
   <listitem>
    <para>
     可选：一个共享磁盘子系统，连接到群集中所有需要访问它的服务器。请参见 <xref linkend="sec.ha.requirements.disk"/>。
    </para>
   </listitem>
   <listitem>
    <para> 一个 <xref linkend="glo.stonith" xrefstyle="select:title nopage"/> 机制。STONITH 设备是群集用于重置被认为出现故障或表现奇怪的节点的电源开关。这是确保挂起节点或者表面上已死机的节点不会发生数据损坏的唯一可靠方法。 </para>
    
   </listitem>
  </itemizedlist>
 </sect1>
<?dbfo-need height="10em"?>


 <sect1 id="sec.ha.requirements.sw">
  <title>软件要求</title>

  <para>
   请确保满足以下软件要求：
  </para>



  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     所有将要加入群集的节点上都安装了 SUSE® Linux Enterprise Server<phrase role="productnumber"><phrase os="sles">12 </phrase></phrase>（包含所有可用的联机更新）。
    </para>
   </listitem>
   <listitem>
    <para>
     所有将要加入群集的节点上都安装了 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> <phrase role="productnumber"><phrase os="sles">12</phrase></phrase>（包含所有可用的联机更新）。
    </para>
   </listitem>
   <listitem>
    <para>如果您要使用地域群集，请确保所有将要加入群集的节点上都安装了 Geo Clustering for SUSE Linux Enterprise High Availability Extension <phrase role="productnumber"><phrase os="sles">12</phrase></phrase>（包含所有可用的联机更新）。 </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <sect1 id="sec.ha.requirements.disk">
  <title>储存要求</title>

  <para> 为确保数据的高可用性，我们建议您为群集设置共享磁盘系统（储存区域网络，简称 SAN）。如果使用共享磁盘子系统，请确保符合以下要求： </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     根据制造商的说明正确设置共享磁盘系统并且共享磁盘系统可正确运行。
    </para>
   </listitem>
   <listitem>
    <para>
     共享磁盘系统中包含的磁盘应配置为使用镜像或 RAID，来为共享磁盘系统增加容错性。建议使用基于硬件的 RAID。所有配置都不支持基于主机的软件 RAID。
    </para>
   </listitem>
   <listitem>
    <para>
     如果准备对共享磁盘系统访问使用 iSCSI，则请确保正确配置了 iSCSI 启动器和目标。
    </para>
   </listitem>
   <listitem>
    <para>
     使用 DRBD* 实施在两台计算机间分发数据的镜像 RAID 系统时，请确保只访问 DRBD 提供的设备，切勿访问备份设备。请与群集的剩余节点使用相同（绑定）的 NIC 来调整此处提供的冗余。
    </para>
   </listitem>
   
  </itemizedlist>
 </sect1>
 <sect1 id="sec.ha.requirements.other">
  <title>其他要求和建议</title>
  <para>为了实现受支持且有用的高可用性设置，请考虑以下建议：</para>
  <variablelist>
   <varlistentry id="vle.ha.req.nodes">
    <term>群集节点数</term>
    <listitem>
     <para>
      
      每个群集必须至少包含两个群集节点。</para>
     <important>
      <title>奇数个数的群集节点</title>
      <para>强烈建议使用<emphasis>奇数</emphasis>个数的群集节点，并且<emphasis>最少</emphasis>有三个节点。 </para>
      <para>群集需要使用<xref linkend="gloss.quorum" xrefstyle="select:label nopage"/>来确保服务处于运行状态。因此，三节点群集只能容许每次有一个节点发生故障，而五节点群集可以容许两个节点发生故障，以此类推。</para>
     </important>
    </listitem>
   </varlistentry>
   <varlistentry id="vle.ha.req.stonith">
    <term>STONITH</term>
    <listitem>
     <important>
      <title>无 STONITH 资源不受支持</title>
      <para> 不支持无 STONITH 资源的群集。 </para>
     </important>
     <para>为了实现受支持的高可用性设置，请确保满足以下条件：</para>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para>高可用性群集中的每个节点必须至少有一个 STONITH 设备（通常是一个硬件）。我们强烈建议为每个节点提供多个 STONITH 设备，除非使用了 SBD。SBD 可让您在群集中启用 STONITH 和屏蔽而无需外部电源开关，但它需要使用共享储存。</para>
      </listitem>
      <listitem>
       <para>全局群集选项 <systemitem>stonith-enabled</systemitem> 和 <systemitem>startup-fencing</systemitem> 必须设置为 <literal>true</literal>。一旦更改这些选项，您将会失去支持。</para>
      </listitem>
     </itemizedlist>
    </listitem>
   </varlistentry>
   <varlistentry id="vle.ha.req.communication">
    <term>冗余通讯路径</term>
    <listitem>
     <para>要实现受支持的高可用性设置，您需要通过两个或更多冗余路径建立群集通讯。这可通过以下方式实现： </para>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para>
        <xref linkend="cha.ha.netbonding" xrefstyle="select:title"/>。 </para>
      </listitem>
      <listitem>
       <para> Corosync 中的另一个通讯通道。有关细节，请参见<xref linkend="pro.ha.installation.setup.channel2"/>。 </para>
      </listitem>
     </itemizedlist>
     <para> 如果可能，请选择网络设备绑定。 </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>时间同步</term>
    <listitem>
     <para> 群集节点应同步到群集外的 NTP 服务器。 有关更多信息，请参见 <ulink url="http://www.suse.com/doc/"/> 上的《SUSE Linux Enterprise Server <phrase role="productnumber"><phrase os="sles">12</phrase></phrase> <citetitle>管理指南</citetitle>》。请参见<citetitle>“使用 NTP 同步时间”</citetitle>一章。 </para>
     <para> 如果节点未同步，将难以分析日志文件和群集报告。 </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>NIC 名称</term>
    <listitem>
     <para> 必须在所有节点上都相同。 </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>主机名和 IP 地址</term>
    <listitem>
     <para> 编辑群集中<emphasis>每台</emphasis>服务器上的 <filename>/etc/hosts</filename> 文件，以配置主机名解析。确保群集通讯速度不受任何 DNS 影响： </para>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para> 使用静态 IP 地址。 </para>
      </listitem>
      <listitem>
       <para> 在此文件中以完全限定的主机名和简短主机名列出所有群集节点。群集成员必须能够按名称找到彼此。如果名称不可用，则将无法进行群集内部通讯。 </para>
      </listitem>
     </itemizedlist>
     <para> 有关更多信息，请参见 <ulink url="http://www.suse.com/doc"/> 上的《SUSE Linux Enterprise Server <phrase role="productnumber"><phrase os="sles">12</phrase></phrase> <citetitle>管理指南</citetitle>》。请参见“<citetitle>基本联网知识</citetitle>”一章中的“<citetitle>使用 YaST 配置网络连接</citetitle>”&gt;“<citetitle>配置主机名和 DNS</citetitle>”小节。 </para>
    </listitem>
   </varlistentry>
   <varlistentry id="vle.ha.req.storage">
    <term>储存要求</term>
    <listitem>
     
     <para>有些服务可能需要使用共享储存。有关要求，请参见<xref linkend="sec.ha.requirements.disk"/>。您也可以使用外部 NFS 共享或 DRBD。如果使用外部 NFS 共享，必须能够从所有群集节点通过冗余通讯路径可靠地访问该共享。请参见<xref linkend="vle.ha.req.communication"/>。 </para>
     <para>如果使用 SBD 作为 STONITH 设备，则共享储存还需要满足其他要求。有关细节，请参见 <ulink url="http://linux-ha.org/wiki/SBD_Fencing"/> 上的“<citetitle>Requirements</citetitle>”（要求）部分。</para>
    </listitem>
   </varlistentry>
   <varlistentry id="vle.ha.req.ssh">
    <term>SSH</term>
    <listitem>
     <para> 所有群集节点都必须能通过 SSH 相互访问。<command>hb_report</command> 或 <command>crm_report</command>（用于查错）和 Hawk 的<guimenu>历史记录浏览器</guimenu>等工具要求节点之间采用无口令 SSH 访问方式，否则它们只能从当前节点收集数据。如果使用非标准 SSH 端口，请使用 <option>-X</option> 选项（参见手册页）。例如，如果 SSH 端口为 <literal>3479</literal>，请使用以下命令调用 <literal>hb_report</literal>：</para>
     
     <screen><prompt role="root">root # </prompt>hb_report -X "-p 3479" [...]</screen>
     <note>
      <title>合规要求</title>
      <para> 如果无口令 SSH 访问不符合法规要求，可以对 <command>crm_report</command> 使用以下变通方法： </para>
      <para> 创建不用密码登录的用户（例如，使用公共密钥进行身份验证）。为该用户配置 <command>sudo</command>，这样无需 <systemitem class="username">root</systemitem> 密码。在命令行上启动 <command>crm_report</command> 时包含 <option>-u</option> 选项，以指定用户名。有关更多信息，请参见 <command>crm_report</command> 手册页。 </para>
      <para> 对于<guimenu>历史记录浏览器</guimenu>，目前还没有其他方式可替代无口令登录。 </para>
     </note>
    </listitem>
   </varlistentry>
   
  </variablelist>
 </sect1>
</chapter>
