<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ha_hawk2_health_i.xml" version="5.0" xml:id="sec-conf-health">
 <title>驗證叢集狀態</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:maintainer/>
   <dm:status>editing</dm:status>
   <dm:deadline/>
   <dm:priority/>
   <dm:translation>yes</dm:translation>
   <dm:languages/>
   <dm:release/>
   <dm:repository/>
  </dm:docmanager>
 </info>

 <para>
  您可以使用 Hawk2 或 crmsh 來檢查叢集的健康情況。
 </para>

 <sect2 xml:id="sec-conf-hawk2-health">
 <title>使用 Hawk2 驗證叢集健康情況</title>
 <para>
  Hawk2 提供了一個精靈用來檢查和偵測叢集存在的問題。分析完成後，Hawk2 會建立包含更多詳細資料的叢集報告。若要驗證叢集狀態並產生報告，Hawk2 需要具有在節點之間進行無密碼 SSH 存取的權限。否則，它只能從目前的節點收集資料。如果您已使用 crm 外圍程序提供的開機程序檔設定叢集，那麼此時已設定好無密碼 SSH 存取權。如果您需要手動設定，請參閱<xref linkend="sec-crmreport-nonroot-ssh"/>。
 </para>

 <procedure>
  <step>
   <para>
    登入 Hawk2：
   </para>
<screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
  </step>
  <step>
   <para>
    從左側導覽列中，選取<menuchoice><guimenu>組態</guimenu>
     <guimenu>精靈</guimenu></menuchoice>。
   </para>
  </step>
  <step>
   <para>
    展開<guimenu>基本</guimenu>類別。
   </para>
  </step>
  <step>
   <para>
    選取<guimenu>驗證狀態和組態</guimenu>精靈。
   </para>
  </step>
  <step>
   <para>
    按一下<guimenu>驗證</guimenu>進行確認。
   </para>
  </step>
  <step>
   <para>
    輸入叢集的 root 密碼，然後按一下<guimenu>套用</guimenu>。Hawk2 會產生報告。
   </para>
  </step>
 </procedure>
 </sect2>

 <sect2 xml:id="sec-ha-manual-config-cli-health">
  <title>使用 crmsh 檢查健康狀態</title>
  <para>
   您可以使用所謂的<quote>程序檔</quote>顯示叢集或節點的<emphasis>健康</emphasis>狀態。程序檔可以執行各種不同的任務，並不局限於顯示狀態。不過，本小節將重點介紹如何獲得健康狀態資訊。
  </para>
  <para>
   若要獲得 <command>health</command> 指令的所有詳細資料，請使用 <command>describe</command>：
  </para>
<screen><prompt role="root"># </prompt><command>crm script describe health</command></screen>
  <para>
   該指令會顯示一則描述和所有參數及其預設值的清單。若要執行程序檔，請使用 <command>run</command>：
  </para>
<screen><prompt role="root"># </prompt><command>crm script run health</command></screen>
  <para>
   如果您希望只執行整套指令中的一個步驟，可以使用 <command>describe</command> 指令列出 <citetitle>Steps</citetitle> 類別中的所有可用步驟。
  </para>
  <para>
   例如，以下指令會執行 <command>health</command> 指令的第一個步驟。輸出會儲存在 <filename>health.json</filename> 檔案中以供進一步調查：
  </para>
<screen><prompt role="root"># </prompt><command>crm script run health statefile='health.json'</command></screen>
  <para>您也可以使用 <command>crm cluster health</command> 執行以上指令。</para>
  <para>
   如需程序檔的其他資訊，請參閱 <link xlink:href="http://crmsh.github.io/scripts/"/>。
  </para>
 </sect2>
</sect1>
