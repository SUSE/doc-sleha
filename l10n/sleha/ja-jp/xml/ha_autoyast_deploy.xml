<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook51-profile.xsl"
 type="text/xml"
 title="Profiling step"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ha_autoyast_deploy.xml" xml:id="sec-ha-installation-autoyast" xml:lang="ja" version="5.1">
  <title>AutoYaSTによるノードの展開</title>
  <info>
    <abstract>
      <para>
        初期クラスタをインストールしてセットアップした後で、AutoYaSTを使用して既存のノードのクローンを作成し、クラスタにそのクローンを追加することによりクラスタを拡張できます。
      </para>
      <para>AutoYaSTでは、インストールおよび設定データを含むプロファイルを使用します。このプロファイルによって、インストールする対象と、インストールしたシステムが最終的に使用準備が整ったシステムになるように設定する方法がAutoYaSTに指示されます。そこでこのプロファイルはさまざまな方法による大量配備に使用できます(たとえば、既存のクラスタノードのクローンなど)。
      </para>
      <para>
        さまざまなシナリオでAutoYaSTを使用する方法の詳細な手順については、<link xlink:href="https://documentation.suse.com/sles-15/html/SLES-all/book-autoyast.html">SUSE Linux Enterprise Server 15 SP7の『AutoYaSTガイド』</link>を参照してください。
      </para>
    </abstract>
    <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
      <dm:bugtracker/>
      <dm:translation>yes</dm:translation>
    </dm:docmanager>
  </info>



  <important>
    <title>同一のハードウェアを使用している環境</title>
    <para>
     <xref linkend="pro-ha-installation-clone-node"/>では、同じハードウェア設定を持つ一群のマシンにSUSE Linux Enterprise High Availability 15 SP7を展開していることを前提としています。
    </para>
    <para>
     同じではないハードウェア上にクラスタノードを展開する必要がある場合は、『SUSE Linux Enterprise Server 15 SP7展開ガイド』、「<citetitle>Automated Installation</citetitle>」の章の「<citetitle>Rule-Based Autoinstallation</citetitle>」セクションを参照してください。
    </para>
  </important>

  <procedure xml:id="pro-ha-installation-clone-node">
   <title>AutoYaSTによるクラスタノードのクローン作成</title>
   <step>
    <para>
     クローンを作成するノードが正しくインストールされ、設定されていることを確認します。詳細については、<xref linkend="cha-ha-bootstrap-install"/>または<xref linkend="cha-ha-ycluster"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     単純な大量インストールについては、『SUSE Linux Enterprise 15 SP7展開ガイド』の説明に従ってください。これには、次の基本ステップがあります。
    </para>
    <substeps performance="required">
     <step>
      <para>
       AutoYaSTプロファイルの作成AutoYaST GUIを使用して、既存のシステム設定を基にプロファイルを作成し、変更します。AutoYaSTでは、<guimenu>高可用性</guimenu>モジュールを選択し、<guimenu>クローン</guimenu>ボタンをクリックします。必要な場合は、他のモジュールの設定を調整し、その結果のコントロールファイルをXMLとして保存します。
      </para>
      <para>
       DRBDを設定した場合、AutoYaST GUIでこのモジュールを選択してクローンを作成することもできます。
      </para>
     </step>
     <step>
      <para>
       AutoYaSTプロファイルのソースと、他のノードのインストールルーチンに渡すパラメータを決定します。
      </para>
     </step>
     <step>
      <para>
       SUSE Linux Enterprise ServerのソースとSUSE Linux Enterprise High Availabilityインストールデータを決定します。
      </para>
     </step>
     <step>
      <para>
       自動インストールのブートシナリオを決定し、設定します。
      </para>
     </step>
     <step>
      <para>
       パラメータを手動で追加するか、または<filename>info</filename>ファイルを作成することにより、インストールルーチンにコマンド行を渡します。
      </para>
     </step>
     <step>
      <para>
       自動インストールプロセスを開始および監視します。
      </para>
     </step>
    </substeps>
   </step>
  </procedure>

  <para>
   クローンのインストールに成功したら、次の手順を実行して、クローンノードをクラスタに加えます。
  </para>

  <procedure xml:id="pro-ha-installation-clone-start">
   <title>クローンノードをオンラインにする</title>
   <step>
    <para>
     既存のノードで、<xref linkend="sec-ha-installation-setup-csync2"/>の説明に従って、新しいノードをCsync2の<guimenu>同期ホスト</guimenu>リストに追加します。
    </para>
   </step>
   <step>
     <para>
       <xref linkend="sec-ha-setup-yast-csync2-sync"/>の説明に従って、Csync2を使用して、設定済みのノードからクローンノードへ重要な設定ファイルを転送します。
     </para>
   </step>
   <step>
    <para>
     ノードをオンラインにするには、<xref linkend="sec-ha-installation-start"/>の説明のとおり、クローンノード上でクラスタサービスを開始します。
    </para>
   </step>
  </procedure>

  <para>
   これで、<filename>/etc/corosync/corosync.conf</filename>ファイルがCsync2を介してクローンノードに適用されたので、クローンノードがクラスタに加わります。CIBは、クラスタノード間で自動的に同期されます。
  </para>

</chapter>
