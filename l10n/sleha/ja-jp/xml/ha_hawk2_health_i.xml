<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ha_hawk2_health_i.xml" version="5.0" xml:id="sec-conf-health">
 <title>クラスタヘルスの確認</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:maintainer/>
   <dm:status>editing</dm:status>
   <dm:deadline/>
   <dm:priority/>
   <dm:translation>yes</dm:translation>
   <dm:languages/>
   <dm:release/>
   <dm:repository/>
  </dm:docmanager>
 </info>

 <para>
  Hawk2またはcrmshのいずれかを使用してクラスタのヘルスを確認できます。
 </para>

 <sect2 xml:id="sec-conf-hawk2-health">
 <title>Hawk2を使用したクラスタヘルスの確認</title>
 <para>
  Hawk2は、クラスタの検査と問題点の検出を行うウィザードを提供します。分析が完了すると、Hawk2は詳細なクラスタレポートを作成します。Hawk2によるクラスタヘルスの確認とレポートの生成には、ノード間のパスワード不要のSSHアクセスが必要です。ない場合は、現在のノードのデータのみを収集します。crmシェルが提供するブートストラップスクリプトでクラスタを設定した場合、パスワード不要のSSHアクセスは既に設定されています。手動で設定する必要がある場合は、<xref linkend="sec-crmreport-nonroot-ssh"/>を参照してください。
 </para>

 <procedure>
  <step>
   <para>
    Hawk2にログインします。
   </para>
<screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
  </step>
  <step>
   <para>
    左のナビゲーションバーから、<menuchoice><guimenu>環境設定</guimenu>
     <guimenu>ウィザード</guimenu></menuchoice>の順に選択します。
   </para>
  </step>
  <step>
   <para>
    <guimenu>基本的</guimenu>カテゴリを展開します。
   </para>
  </step>
  <step>
   <para>
    <guimenu>Verify health and configuration (ヘルスと設定の検証)</guimenu>ウィザードを選択します。
   </para>
  </step>
  <step>
   <para>
    <guimenu>検証</guimenu>を選択して確認します。
   </para>
  </step>
  <step>
   <para>
    クラスタのルートパスワードを入力して、<guimenu>適用</guimenu>をクリックします。Hawk2はレポートを生成します。
   </para>
  </step>
 </procedure>
 </sect2>

 <sect2 xml:id="sec-ha-manual-config-cli-health">
  <title>crmshを使用したヘルスステータスの取得</title>
  <para>
   クラスタまたはノードの<quote>ヘルス</quote>ステータスは、<emphasis></emphasis>「スクリプト」というもので表示できます。スクリプトは、ヘルスだけに限らず各タスクを実行できます。ただし、このサブセクションでは、ヘルスステータスを取得する方法に焦点を当てます。
  </para>
  <para>
   <command>health</command>コマンドに関するすべての詳細を取得するには、<command>describe</command>を使用します。
  </para>
<screen><prompt role="root"># </prompt><command>crm script describe health</command></screen>
  <para>
   このコマンドは、すべてのパラメータの説明とリスト、およびそのデフォルト値を示します。スクリプトを実行するには、<command>run</command>を使用します。
  </para>
<screen><prompt role="root"># </prompt><command>crm script run health</command></screen>
  <para>
   スイートから1つのステップのみを実行したい場合は、<command>describe</command>コマンドの<citetitle>Steps</citetitle>カテゴリで、使用可能なすべてのステップを一覧表示できます。
  </para>
  <para>
   たとえば、次のコマンドは、<command>health</command>コマンドの最初のステップを実行します。さらなる調査のために、出力が<filename>health.json</filename>に保存されます。
  </para>
<screen><prompt role="root"># </prompt><command>crm script run health statefile='health.json'</command></screen>
  <para>上記のコマンドは、<command>crm cluster health</command>でも実行できます。</para>
  <para>
   スクリプトに関する追加情報を表示するには、<link xlink:href="http://crmsh.github.io/scripts/"/>を参照してください。
  </para>
 </sect2>
</sect1>
