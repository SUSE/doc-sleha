<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ha_install.xml" version="5.0" xml:id="cha-ha-install">
<?dbfo-need height="20em"?>

 <title>High Availability Extensionのインストール</title>
 <info>
  <abstract>
   <para>初めて<phrase role="roductnamereg"><phrase os="sles">SUSE® Linux Enterprise High Availability Extension</phrase></phrase>を使用してHigh Availabilityクラスタを設定する場合、最も簡単な方法は、基本的な2ノードクラスタで開始することです。2ノードクラスタを使用して、一部のテストを実行することもできます。後で、AutoYaSTを使用して既存のクラスタノードのクローンを作成することにより、さらにノードを追加できます。クローンを作成したノードには、元のノードと同じパッケージがインストールされ、クローンノードは同じシステム設定を持つことになります。
   </para>
   <para>
    前のバージョンの<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase>を実行する既存のクラスタをアップグレードする場合は、<xref linkend="cha-ha-migration"/>を参照してください。
   </para>
  </abstract>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:maintainer/>
   <dm:status>editing</dm:status>
   <dm:deadline/>
   <dm:priority/>
   <dm:translation>yes</dm:translation>
   <dm:languages/>
   <dm:release/>
   <dm:repository/>
  </dm:docmanager>
 </info>
 
 <sect1 xml:id="sec-ha-install-manual">
  <title>手動インストール</title>
  <para>
   High Availability Extension用のパッケージの手動インストールについては、<xref linkend="article-installation"/>を参照してください。このマニュアルでは、基本的な2ノードクラスタをセットアップする手順を説明しています。
  </para>
 </sect1>
  <sect1 xml:id="sec-ha-installation-autoyast">
  <title>AutoYaSTによる大量インストールと展開</title>

  <para>
   2ノードクラスタをインストールしてセットアップした後で、AutoYaSTを使用して既存のノードのクローンを作成し、クラスタにそのクローンを追加することによりクラスタを拡張できます。
  </para>
   
   <para>AutoYaSTでは、インストールおよび設定データを含むプロファイルを使用します。このプロファイルによって、インストールする対象と、インストールしたシステムが最終的に使用準備が整ったシステムになるように設定する方法がAutoYaSTに指示されます。そこでこのプロファイルはさまざまな方法による大量配備に使用できます(たとえば、既存のクラスタノードのクローンなど)。</para>

   <para>
    さまざまなシナリオでAutoYaSTを使用する方法の詳細な手順については、<link xlink:href="https://documentation.suse.com/sles-15/html/SLES-all/book-autoyast.html">
     SUSE Linux Enterprise Server <phrase role="productnumber"><phrase os="sles">15 SP4</phrase></phrase>の<citetitle>『AutoYaSTガイド</citetitle>』</link>を参照してください。
   </para>

   <important>
    <title>同一のハードウェアを使用している環境</title>
    <para>
     <xref linkend="pro-ha-installation-clone-node"/>では、同じハードウェア構成を持つ一群のマシンに<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> <phrase role="productnumber"><phrase os="sles">15 SP4</phrase></phrase>を展開していることを前提としています。
    </para>
    <para>
     同じではないハードウェア上にクラスタノードを展開する必要がある場合は、『SUSE Linux Enterprise <citetitle>15 SP4<phrase role="productnumber"><phrase os="sles">導入ガイド』</phrase></phrase></citetitle>、「Automated Installation」の章の<citetitle></citetitle>「Rule-Based Autoinstallation」セクション<citetitle></citetitle>を参照してください。
    </para>
   </important>



  <procedure xml:id="pro-ha-installation-clone-node">
   <title>AutoYaSTによるクラスタノードのクローン作成</title>
   <step>
    <para>
     クローンを作成するノードが正しくインストールされ、設定されていることを確認します。詳細については、<citetitle></citetitle><phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase>用の『インストールおよびセットアップクイックスタート』または<xref linkend="cha-ha-ycluster"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     単純な大量インストールについては、『SUSE Linux Enterprise 15 SP4 導入ガイド<citetitle><phrase role="productnumber"><phrase os="sles"></phrase></phrase></citetitle>』の説明に従ってください。これには、次の基本ステップがあります。
    </para>
    <substeps performance="required">
     <step>
      <para>
       AutoYaSTプロファイルの作成AutoYaST GUIを使用して、既存のシステム設定をもとにプロファイルを作成し、変更します。AutoYaSTでは、<guimenu>高可用性</guimenu>モジュールを選択し、<guimenu>クローン</guimenu>ボタンをクリックします。必要な場合は、他のモジュールの設定を調整し、その結果のコントロールファイルをXMLとして保存します。
      </para>

      <para>
       DRBDを設定した場合、AutoYaST GUIでこのモジュールを選択してクローンを作成することもできます。
      </para>
     </step>
     <step>
      <para>
       AutoYaSTプロファイルのソースと、他のノードのインストールルーチンに渡すパラメータを決定します。
      </para>
     </step>
     <step>
      <para>
       SUSE Linux Enterprise Serverのソースと<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase>インストールデータを決定します。
      </para>
     </step>
     <step>
      <para>
       自動インストールのブートシナリオを決定し、設定します。
      </para>
     </step>
     <step>
      <para>
       パラメータを手動で追加するか、または<filename>info</filename>ファイルを作成することにより、インストールルーチンにコマンド行を渡します。
      </para>
     </step>
     <step>
      <para>
       自動インストールプロセスを開始および監視します。
      </para>
     </step>
    </substeps>
   </step>
  </procedure>

  <para>
   クローンのインストールに成功したら、次の手順を実行して、クローンノードをクラスタに加えます。
  </para>

  <procedure xml:id="pro-ha-installation-clone-start">
   <title>クローンノードをオンラインにする</title>
   <step>
    <para>
     <xref linkend="sec-ha-installation-setup-csync2"/>の説明に従って、Csync2を使用して、設定済みのノードからクローンノードへ重要な設定ファイルを転送します。
    </para>
   </step>
   <step>
    <para>
     ノードをオンラインにするには、<xref linkend="sec-ha-installation-start"/>の説明のとおり、クローンノード上でPacemakerサービスを開始します。
    </para>
   </step>
  </procedure>

  <para>
   これで、<filename>/etc/corosync/corosync.conf</filename>ファイルがCsync2を介してクローンノードに適用されたので、クローンノードがクラスタに加わります。CIBは、クラスタノード間で自動的に同期されます。
  </para>
 </sect1>
</chapter>
