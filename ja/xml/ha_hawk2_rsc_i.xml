<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ha_hawk2_rsc_i.xml" version="5.0" xml:id="sec.conf.hawk2.rsc">
 <title>クラスタリソースの設定</title>
 <info>
      <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
        <dm:maintainer/>
        <dm:status>編集</dm:status>
        <dm:deadline/>
        <dm:priority/>
        <dm:translation>yes</dm:translation>
        <dm:languages/>
        <dm:release/>
        <dm:repository/>
      </dm:docmanager>
 </info>
 
  <para>
   クラスタの管理者は、クラスタ内のサーバ上の各リソースや、サーバ上で実行する各アプリケーションに対してクラスタリソースを作成する必要があります。クラスタリソースには、Webサイト、メールサーバ、データベース、ファイルシステム、仮想マシン、およびユーザが常時使用できるその他のサーバベースのアプリケーションまたはサービスなどが含まれます。
  </para>
  
  <para>
   作成できるリソースタイプの概要については、<xref linkend="sec.ha.config.basics.resources.types"/>を参照してください。リソースの基本情報(ID、クラス、プロバイダ、およびタイプ)を指定すると、Hawk2によって次のカテゴリが表示されます。
  </para>
  
  <variablelist>
   <varlistentry>
    <term>パラメータ(インスタンス属性)</term>
    <listitem>
     <para>リソースが制御するサービスのインスタンスを決定します。詳細については、<xref linkend="sec.ha.config.basics.inst.attr"/>を参照してください。 </para>
     <para> リソースを作成する際、Hawk2は必要なパラメータを自動的に表示します。これらを編集して、有効なリソースの設定を取得します。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>操作</term>
    <listitem>
     <para>リソース監視に必要です。詳細については、<xref linkend="sec.ha.config.basics.operations"/>を参照してください。</para>
     <para> リソースを作成する際、Hawk2は、重要なリソース操作を表示します(<literal>monitor</literal>、<literal>start</literal>、および<literal>stop</literal>)。 </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>メタ属性</term>
    <listitem>
     <para>特定のリソースの処理方法をCRMに指示します。詳細については、<xref linkend="sec.ha.config.basics.meta.attr"/>を参照してください。 </para>
     <para> リソースを作成する際、Hawk2はそのリソースの重要なメタ属性を自動的にリストにします(たとえばリソースの初期状態を定義する<literal>target-role</literal>属性です。デフォルトでは<literal>Stopped</literal>に設定されているため、リソースはすぐには始動しません)。 </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>使用率</term>
    <listitem>
    <para>特定のリソースがノードから要求する容量をCRMに指示します。詳細については、<xref linkend="sec.config.hawk2.utilization"/>を参照してください。
    </para>
    </listitem>
   </varlistentry>
  </variablelist>
  <para>これらのカテゴリのエントリと値は、リソースの作成中に調整することも、後から調整することもできます。</para>

  <sect2 xml:id="sec.conf.hawk2.rsc.show">
   <title>現在のクラスタ設定の表示(CIB)</title>
   <para>
    クラスタ管理者はクラスタ設定を知る必要がある場合があります。Hawk2は、現在の設定をcrmシェル構文で、XMLとして、およびグラフとして表示できます。クラスタ設定をcrmシェル構文で表示するには、左ナビゲーションバーから、<guimenu>Edit Configuration (設定の編集)</guimenu>を選択し、<guimenu>Show (表示)</guimenu>をクリックします。代わりに設定をraw XMLで表示するには、<guimenu>XML</guimenu>をクリックします。CIBで設定されたノードとリソースのググラフィカルな表現を示すには、<guimenu>グラフ</guimenu>をクリックします。リソース間の関係も表示されます。
    </para>
  </sect2>

  <sect2 xml:id="sec.conf.hawk2.rsc.wizard">
   <title>ウィザードを使用したリソースの追加</title>
   <para>Hawk2ウィザードは、仮想IPアドレスやSDB STONITHリソースなどの単純なリソースを設定する場合に便利です。しかし、このウィザードが最も役に立つのは、DRBDブロックデバイスやApache Webサーバのリソース設定など、複数のリソースが含まれる複雑な設定を行う場合です。設定手順をウィザードに従って進めることができ、入力が必要なパラメータについては情報が提供されます。</para>
   <procedure xml:id="pro.conf.hawk2.wizard">
    <title>リソースウィザードの使用</title>
    <step>
    <para>Hawk2にログインします。</para>
    <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
   </step>
   <step>
     <para>左のナビゲーションバーから、<guimenu>Wizards (ウィザード)</guimenu>を選択します。
    </para>
    </step>
    <step>
     <para>ウィザードの横にある下矢印アイコンをクリックして個々のカテゴリを展開し、目的のウィザードを選択します。</para>
    </step>
    <step>
     <para>画面の指示に従います。最後の設定手順が完了したら、<guimenu>Verify (検証)</guimenu>を選択して、入力した値を検証します。</para>
     <para>Hawk2が実行するアクションと、設定の内容が表示されます。設定によっては、<guimenu>Apply (適用)</guimenu>を選択して設定を適用する前に、<systemitem class="username">root</systemitem>パスワードの入力を求めるプロンプトが表示されることがあります。</para>
    </step>
   </procedure>
   <figure pgwide="0">
    <title>Hawk2 - Apache Webサーバ用のウィザード</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="hawk2-wizard-apache.png" width="100%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="hawk2-wizard-apache.png" width="100%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>
  <sect2 xml:id="sec.conf.hawk2.rsc.primitive">
   <title>単純なリソースの追加</title>
    <para>
     最も基本的なタイプのリソースを作成するには、次の手順に従います。
    </para>
   <procedure xml:id="pro.conf.hawk2.primitive.add">
    <title>プリミティブリソースの追加</title>
    <step>
     <para>Hawk2にログインします。</para>
     <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
    </step>
    <step>
     <para>左のナビゲーションバーから、<menuchoice>
       <guimenu>Add Resource (リソースの追加)</guimenu>
       <guimenu>Primitive (プリミティブ)</guimenu>
      </menuchoice>の順に選択します。</para>
    </step>
    <step>
     <para> 固有の<guimenu>リソースID</guimenu>を入力します。 </para>
    </step>
    <step>
     <para>リソース設定の基にするリソーステンプレートが存在する場合は、<guimenu>Template (テンプレート)</guimenu>で目的のテンプレートを選択します。テンプレートの設定の詳細については、<xref linkend="pro.conf.hawk2.template.add"/>を参照してください。 </para>
    </step>
    <step xml:id="step.ha.config.hawk2.primitive.start">
     <para><guimenu>クラス</guimenu>で、使用するリソースエージェントのクラスを選択します。<literal>lsb</literal>、<literal>ocf</literal>、<literal>service</literal>、<literal>stonith</literal>、または<literal>systemd</literal>から選択できます。詳細については、<xref linkend="sec.ha.config.basics.raclasses"/>を参照してください。 </para>
    </step>
    <step>
     <para> <literal>ocf</literal>をクラスとして選択した場合、OCFリソースエージェントの<guimenu>プロバイダ</guimenu>を指定します。OCFの指定によって、複数のベンダが同じリソースエージェントを提供できるようになります。
     </para>
    </step>
    <step>
     <para> <guimenu>タイプ</guimenu>リストから、使用するリソースエージェントを選択します(たとえば<guimenu>IPaddr</guimenu>または<guimenu>Filesystem</guimenu>)。このリソースエージェントの簡単な説明が表示されます。</para>
     <para>これで、リソースの基本情報が指定されました。</para>
     <note>
       <para> <guimenu>タイプ</guimenu>リストに表示される選択肢は、選択した<guimenu>クラス</guimenu>(OCFリソースの場合は、<guimenu>プロバイダ</guimenu>も)によって異なります。 </para>
     </note>
     <figure>
      <title>Hawk2 - プリミティブリソース</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="hawk2-primitive-basic.png" width="100%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="hawk2-primitive-basic.png" width="100%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>Hawk2によって提案された<guimenu>Parameters (パラメータ)</guimenu>、<guimenu>Operations (操作)</guimenu>、および<guimenu>メタ属性</guimenu>を保持する場合は、<guimenu>Create (作成)</guimenu>をクリックして設定を終了します。画面上部に、アクションが成功したかどうかを示すメッセージが表示されます。 </para>
     <para>パラメータ、操作、またはメタ属性を調整するには、<xref linkend="sec.conf.hawk2.rsc.modify"/>を参照してください。リソースの<guimenu>Utilization (使用)</guimenu>属性を設定するには、<xref linkend="pro.hawk2.utilization.rsc"/>を参照してください。
     </para>
    </step>
   </procedure>
  </sect2>
 <sect2 xml:id="sec.conf.hawk2.rsc.template">
  <title>リソーステンプレートの追加</title>
   <para>
    類似した設定のリソースを多く作成する最も簡単な方法は、リソーステンプレートを定義することです。リソーステンプレートを定義した後は、プリミティブの中や、特定のタイプの制約で参照できるようになります。リソーステンプレートの機能と使用方法の詳細については、<xref linkend="sec.ha.config.basics.constraints.templates"/>を参照してください。
   </para>
   <procedure xml:id="pro.conf.hawk2.template.add">
    <title>リソーステンプレートの追加</title>
    <para>リソーステンプレートは、プリミティブリソースと同様の方法で設定します。</para>
    <step>
     <para>Hawk2にログインします。</para>
     <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
    </step>
    <step>
     <para>左のナビゲーションバーから、<menuchoice>
       <guimenu>Add Resource(リソースの追加)</guimenu>
       <guimenu>Template (テンプレート)</guimenu>
      </menuchoice>の順に選択します。</para>
    </step>
    <step>
     <para> 固有の<guimenu>リソースID</guimenu>を入力します。 </para>
    </step>
    <step>
     <para><xref linkend="pro.conf.hawk2.primitive.add"/>の<xref linkend="step.ha.config.hawk2.primitive.start" xrefstyle="select:label"/>以降の手順に従います。</para>
    </step>
   </procedure>
  </sect2>
  
  <sect2 xml:id="sec.conf.hawk2.rsc.modify">
   <title>リソースの変更</title>
   <para>リソースの作成後、必要に応じてパラメータ、操作、またはメタ属性を調整することで、いつでもその設定を編集できます。</para>
   
   <procedure xml:id="pro.conf.hawk2.rsc.modify">
    <title>パラメータ、操作、またはメタ属性の変更</title>
    <step>
     <para>Hawk2にログインします。</para>
     <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
    </step>
    <step>
     <para>Hawk2の<guimenu>Status (状態)</guimenu>画面で、<guimenu>Resources (リソース)</guimenu>リストに移動します。</para>
    </step>
    <step>
     <para><guimenu>Operations (操作)</guimenu>列で、変更したいリソースまたはグループの横にある下矢印アイコンをクリックして<guimenu>Edit (編集)</guimenu>を選択します。</para>
     <para>リソース設定画面が開きます。</para>
     <figure>
      <title>Hawk2 - プリミティブリソースの編集</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="hawk2-primitive-edit.png" width="100%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="hawk2-primitive-edit.png" width="100%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step xml:id="step.hawk2.rsc.modify.params">
     <para>新しいパラメータ、操作、またはメタ属性を追加するには、空のドロップダウンボックスからエントリを選択して、その横にある<guimenu>プラス</guimenu>アイコンをクリックし、それぞれのカテゴリにエントリを追加します。</para>
    </step>
    <step>
     <para><guimenu>Operations (操作)</guimenu>カテゴリの値を編集するには、それぞれのカテゴリの<guimenu>Edit (編集)</guimenu>アイコンをクリックして操作の別の値を入力し、<guimenu>Apply (適用)</guimenu>をクリックします。
     </para>
    </step>
    <step>
     <para>完了したら、リソース設定画面で<guimenu>Apply (適用)</guimenu>ボタンをクリックして、パラメータ、操作、またはメタ属性の変更内容を確認します。</para>
     <para>画面上部に、アクションが成功したかどうかを示すメッセージが表示されます。</para>
    </step>
   </procedure>
   
  </sect2>

  <sect2 xml:id="sec.conf.hawk2.rsc.stonith">
   <title>STONITHリソースの追加</title>
    <important>
      <title>STONITHがない場合はサポートなし</title>
      <itemizedlist>
       <listitem>
        <para>クラスタにはノードフェンシングメカニズムが必要です。</para>
       </listitem>
       <listitem>
        <para>グローバルクラスタオプション<systemitem>stonith-enabled</systemitem>および<systemitem>startup-fencing</systemitem>を<literal>true</literal>に設定する必要があります。これらのオプションを変更すると、ただちにサポートが失われます。</para>
       </listitem>
      </itemizedlist>
      </important>
   <para>
    デフォルトでは、グローバルクラスタオプション<literal>stonith-enabled</literal>は<literal>true</literal>に設定されています。STONITHリソースが定義されていない場合、クラスタはどのリソースの開始も拒否します。1つ以上のSTONITHリソースを設定して、STONITHのセットアップを完了します。SBD、libvirt (KVM/Xen)、またはvCenter/ESX ServerのSTONITHリソースを追加する場合、Hawk2ウィザードを使用するのが最も簡単な方法です(<xref linkend="sec.conf.hawk2.rsc.wizard"/>を参照してください)。STONITHは他のリソースと同様に設定しますが、その動作はいくつかの点で異なっています。詳細については、<xref linkend="sec.ha.fencing.config"/>を参照してください。
   </para>
   <procedure xml:id="pro.conf.hawk2.stonith">
    <title>STONITHリソースの追加</title>
    <step>
     <para>Hawk2にログインします。</para>
     <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
    </step>
    <step>
     <para>左のナビゲーションバーから、<menuchoice>
      <guimenu>Add Resource (リソースの追加)</guimenu>
      <guimenu>Primitive (プリミティブ)</guimenu>
     </menuchoice>の順に選択します。</para>
    </step>
    <step>
     <para> 固有の<guimenu>リソースID</guimenu>を入力します。 </para>
    </step>
      <step>
       <para>
        <guimenu>クラス</guimenu>リストで、リソースエージェントクラスとして<guimenu>stonith</guimenu>を選択します。
       </para>
      </step>
      <step>
       <para>
        <guimenu>タイプ</guimenu>リストから、使用しているSTONITHデバイスを制御するためのSTONITHプラグインを選択します。このプラグインの簡単な説明が下に表示されます。
       </para>
      </step>
     <step>
     <para>
      Hawk2は、自動的にそのリソースに必要な<guimenu>パラメータ</guimenu>を表示します。それぞれのパラメータの値を入力します。
     </para>
    </step>
    <step>
     <para>
      Hawk2は、重要なリソース<guimenu>操作</guimenu>を表示し、デフォルト値を提案します。ここで設定を変更しない場合、確定するとすぐに、Hawk2は提案した操作およびデフォルト値を追加します。
     </para>
    </step>
    <step>
     <para>
      変更理由がない場合は、デフォルトの<guimenu>メタ属性</guimenu>設定を保持します。
     </para>
     <figure>
      <title>Hawk2 - STONITHリソース</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="hawk2-primitive-stonith.png" width="100%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="hawk2-primitive-stonith.png" width="100%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      変更を確認して、STONITHリソースを作成します。
     </para>
     <para>画面上部に、アクションが成功したかどうかを示すメッセージが表示されます。</para>
    </step>
   </procedure>
   <para>
    フェンシングを設定するには、制約を追加します。詳細については、<xref linkend="cha.ha.fencing"/>を参照してください。
   </para>
  </sect2>
  <sect2 xml:id="sec.conf.hawk2.rsc.group">
   <title>クラスタリソースグループの追加</title>
   <para>
    クラスタリソースの中には、他のコンポーネントやリソースに依存しており、各コンポーネントや各リソースを特定の順序で開始することや、同じサーバ上で一緒に実行することが必要なものもあります。この設定を簡単にするため、<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase>は、グループのコンセプトをサポートしています。
   </para>
   
   
   <para>リソースグループには、一緒の場所で見つけ、連続して開始し、逆の順序で停止する必要のあるリソースセットが含まれます。リソースグループの例と、グループとそのプロパティの詳細について、<xref linkend="sec.ha.config.basics.resources.advanced.groups"/>を参照してください。
   </para>
   <note>
    <title>空のグループ</title>
    <para>
     グループには1つ以上のリソースを含む必要があります。空の場合は設定は無効になります。グループの作成中に、Hawk2ではさらにプリミティブを作成し、それらをグループに追加できます。詳細については、<xref linkend="sec.conf.hawk2.manage.edit"/>を参照してください。
    </para>
   </note>
   <procedure xml:id="pro.conf.hawk2.group">
    <title>リソースグループを追加する</title>
    <step>
     <para>Hawk2にログインします。</para>
     <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
    </step>
    <step>
     <para>左ナビゲーションバーから、<menuchoice>
      <guimenu>Add Resource (リソースの追加)</guimenu>
      <guimenu>Gr up (グループ)</guimenu>
     </menuchoice>の順に選択します。</para>
    </step>
    <step>
     <para>
      固有の<guimenu>グループID</guimenu>を入力します。
     </para>
    </step>
    <step>
     <para>
      グループメンバーを定義するには、<guimenu>Children (子)</guimenu>リストで1つまたは複数のエントリを選択します。グループメンバーを再ソートするには、右側の<quote>ハンドル</quote>アイコンを使用して、メンバーを目的の順序にドラッグアンドドロップします。
     </para>
    </step>
    <step>
     <para>
      必要に応じて、<guimenu>メタ属性</guimenu>を変更または追加します。
     </para>
    </step>
    <step>
     <para>
      <guimenu>Create (作成)</guimenu>をクリックして、設定を完了します。画面上部に、アクションが成功したかどうかを示すメッセージが表示されます。
     </para>
    </step>
   </procedure>
   <figure>
    <title>Hawk2 - リソースグループ</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="hawk2-rsc-group.png" width="100%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="hawk2-rsc-group.png" width="100%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>
  
  <sect2 xml:id="sec.conf.hawk2.rsc.clone">
   <title>クローンリソースの追加</title>
   <para> 特定のリソースをクラスタ内の複数のノードで同時に実行することが必要な場合には、それらのリソースをクローンとして設定します。クローンとして設定できるリソースの一例は、OCFS2などのクラスタファイルシステムの<literal>ocf:pacemaker:controld</literal>です。標準のリソースまたはリソースグループであれば、どれでもクローンを作成できます。クローンリソースの各インスタンスは、すべて同じ動作にすることができます。ただし、ホストされているノードに応じて設定を変えることもできます。</para>
   <para>
    利用可能なリソースクローンのタイプの概要は、<xref linkend="sec.ha.config.basics.resources.advanced.clones"/>を参照してください。
   </para>
   <note>
    <title>クローンの子リソース</title>
    <para>
     クローンには、プリミティブまたはグループのいずれかを子リソースとして含めることができます。Hawk2では、クローンの作成中に子リソースを作成したり変更したりすることはできません。クローンを追加する前に、子リソースを作成し、必要に応じて設定しておいてください。詳細については、<xref linkend="sec.conf.hawk2.rsc.primitive"/>または<xref linkend="sec.conf.hawk2.rsc.group"/>を参照してください。
    </para>
   </note>
   <procedure xml:id="pro.conf.hawk2.clone">
    <title>クローンリソースの追加</title>
    <step>
     <para>Hawk2にログインします。</para>
     <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
    </step>
    <step>
     <para>左のナビゲーションバーから、<menuchoice>
      <guimenu>Add Resource (リソースの追加)</guimenu>
      <guimenu>Clone (クローン)</guimenu>
     </menuchoice>の順に選択します。</para>
    </step>
    <step>
     <para>
      固有の<guimenu>クローンID</guimenu>を入力します。
     </para>
    </step>
    <step>
     <para>
      <guimenu>子リソース</guimenu>リストから、クローンのサブリソースとして使用するプリミティブまたはグループを選択します。
     </para>
    </step>
    <step>
     <para>
      必要に応じて、<guimenu>メタ属性</guimenu>を変更または追加します。
     </para>
    </step>
    <step>
     <para>
      <guimenu>Create (作成)</guimenu>をクリックして、設定を完了します。画面上部に、アクションが成功したかどうかを示すメッセージが表示されます。
     </para>
    </step>
   </procedure>
   <figure>
    <title>Hawk2 - クローンリソース</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="hawk2-clone.png" width="100%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="hawk2-clone.png" width="100%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>
  <sect2 xml:id="sec.conf.hawk2.rsc.ms">
   <title>マルチステートリソースの追加</title>
   <para>マルチステートリソースは、クローンが得意とするところです。これにより、インスタンスを2つの動作モード(<literal>active/passive</literal>、<literal>primary/secondary</literal>、または<literal>master/slave</literal>と呼ばれます)のいずれかに設定できます。マルチステートリソースは、グループまたは通常リソースを1つだけ含む必要があります。 </para>
   <para>
    リソースの監視または制約を設定する場合、マルチステートリソースには、単純なリソースとは異なる要件があります。詳細については、『<citetitle>Pacemaker Explained</citetitle>』(<link xlink:href="http://www.clusterlabs.org/doc/"/>から入手可)を参照してください。特に、「<citetitle>Multi-state - Resources That Have Multiple Modes</citetitle>」のセクションを参照してください。
   </para>
  
   <note>
    <title>マルチステートリソースの子リソース</title>
    <para>
     マルチステートリソースには、プリミティブまたはグループのいずれかを子リソースとして含めることができます。Hawk2では、マルチステートリソースの作成中に子リソースを作成したり変更したりすることはできません。マルチステートリソースを追加する前に、子リソースを作成し、必要に応じて設定しておいてください。詳細については、<xref linkend="sec.conf.hawk2.rsc.primitive"/>または<xref linkend="sec.conf.hawk2.rsc.group"/>を参照してください。
    </para>
   </note>
   <procedure xml:id="pro.conf.hawk2.ms">
    <title>マルチステートリソースの追加</title>
    <step>
     <para>Hawk2にログインします。</para>
     <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
    </step>
    <step>
     <para>左のナビゲーションバーから、<menuchoice>
      <guimenu>Add Resource (リソースの追加)</guimenu>
      <guimenu>Multi-state (マルチステート)</guimenu>
     </menuchoice>の順に選択します。</para>
    </step>
    <step>
     <para>
      <guimenu>Multi-state ID (マルチステートID)</guimenu>に固有のIDを入力します。
     </para>
    </step>
    <step>
     <para>
      <guimenu>子リソース</guimenu>リストから、マルチステートリソースのサブリソースとして使用するプリミティブまたはグループを選択します。
     </para>
    </step>
    <step>
     <para>
      必要に応じて、<guimenu>メタ属性</guimenu>を変更または追加します。
     </para>
    </step>
    <step>
     <para>
      <guimenu>Create (作成)</guimenu>をクリックして、設定を完了します。画面上部に、アクションが成功したかどうかを示すメッセージが表示されます。
     </para>
    </step>
   </procedure>
   <figure>
    <title>Hawk2 - マルチステートリソース</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="hawk2-multi-state.png" width="100%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="hawk2-multi-state.png" width="100%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>
  <sect2 xml:id="sec.conf.hawk2.rsc.tag">
   <title>タグの使用によるリソースのグループ化</title>
   <para>タグは、コロケーションの作成や関係の順序付けを行わずに、複数のリソースをただちに参照する方法です。タグを使用して、概念的に関連するリソースをグループ化できます。たとえば、データベースに関連する複数のリソースがある場合、関連するすべてのリソースを<literal>database</literal>という名前のタグに追加できます。</para>
   <para>
    同じタグに属するすべてのリソースは、1つのコマンドで開始または停止できます。</para>
  
   <procedure xml:id="pro.conf.hawk2.tag">
    <title>タグの追加</title>
    <step>
     <para>Hawk2にログインします。</para>
     <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
    </step>
    <step>
     <para>左のナビゲーションバーから、<menuchoice>
      <guimenu>Add Resource (リソースの追加)</guimenu>
      <guimenu>Tag (タグ)</guimenu>
     </menuchoice>の順に選択します。</para>
    </step>
    <step>
     <para>
      <guimenu>Tag ID (タグID)</guimenu>に固有のIDを入力します。
     </para>
    </step>
    <step>
     <para> <guimenu>Objects (オブジェクト)</guimenu>リストから、このタグで参照するリソースを選択します。 </para>
    </step>
    <step>
     <para>
      <guimenu>Create (作成)</guimenu>をクリックして、設定を完了します。画面上部に、アクションが成功したかどうかを示すメッセージが表示されます。
     </para>
    </step>
   </procedure>
   <figure>
    <title>Hawk2 - タグ</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="hawk2-tag.png" width="100%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="hawk2-tag.png" width="100%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>
  <sect2 xml:id="sec.conf.hawk2.rsc.monitor">
   <title>リソース監視の設定</title>
   <para> High Availability Extensionは、ノードの障害を検出するだけではなく、ノードの個々のリソースで障害が発生した場合、そのことも検出します。リソースが実行中であるかどうか確認するには、そのリソースにリソースの監視を設定します。通常、リソースは動作中にのみ、クラスタによって監視されます。しかし、同時実行違反を検出するために、停止されるリソースの監視も設定する必要があります。リソースを監視するには、タイムアウト、開始遅延のいずれか、または両方と、間隔を指定します。間隔の指定によって、CRMにリソースステータスの確認頻度を指示します。<literal>start</literal>または<literal>stop</literal>操作に対する<literal>timeout</literal>など、特定のパラメータも設定できます。</para>
   <procedure xml:id="pro.hawk2.operations">
    <title>操作の追加または変更</title>
    
    <step>
     <para>Hawk2にログインします。</para>
     <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
    </step>
    <step>
     <para> <xref linkend="pro.conf.hawk2.primitive.add"/>の説明に従ってリソースを追加するか、既存のプリミティブを選択して編集します。</para>
     <para>Hawk2は、重要な<guimenu>操作</guimenu>(<literal>start</literal>、<literal>stop</literal>、<literal>monitor</literal>)を自動的に表示し、デフォルト値を提案します。 </para>
     <para>提案された各値に属する属性を参照するには、マウスポインタをそれぞれの値に合わせます。</para>
     <informalfigure>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="hawk2-monitor-op.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="hawk2-monitor-op.png" width="60%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
    </step>
    <step>
     <para><literal>start</literal>または<literal>stop</literal>操作に対して提案された<literal>timeout</literal>の値を変更するには、次の手順に従います。 </para>
     <substeps>
      <step>
       <para> 操作の隣のペンアイコンをクリックします。</para>
      </step>
      <step>
       <para>表示されるダイアログで、<literal>timeout</literal>パラメータに別の値(例: <literal>10</literal>)を入力し、変更内容を確認します。</para>
      </step>
     </substeps>
    </step>
    <step>
     <para><literal>monitor</literal>操作に対して提案された<guimenu>interval</guimenu>の値を変更するには、次の手順に従います。</para>
     <substeps>
      <step>
       <para> 操作の隣のペンアイコンをクリックします。</para>
      </step>
      <step>
       <para>表示されるダイアログで、<literal>interval</literal>に対して監視間隔の別の値を入力します。 </para>
      </step>
      <step>
       <para>リソースが停止されている場合にリソース監視を設定するには、次の手順に従います。</para>
       <substeps>
        <step>
         <para>下にある空のドロップダウンボックスから［<literal>role (役割)</literal>］エントリを選択し、その横にある<guimenu>プラス</guimenu>アイコンをクリックして新しいパラメータを追加します。</para>
        </step>
        <step>
         <para>［<literal>role (役割)</literal>］ドロップダウンボックスから、［<literal>Stopped (停止)</literal>］を選択します。</para>
        </step>
        <step>
         <para><guimenu>Apply (適用)</guimenu>をクリックし、変更内容を確認して操作のダイアログを閉じます。</para>
        </step>
       </substeps>
      </step>
     </substeps>
    </step>
    <step>
     <para>リソース設定画面で変更内容を確認します。画面上部に、アクションが成功したかどうかを示すメッセージが表示されます。</para>
    </step>
   </procedure>

   <para> リソースモニタが障害を検出した場合の処理については、<xref linkend="sec.ha.config.basics.monitoring"/>を参照してください。 </para>
   <para>
    リソースの障害を表示するには、Hawk2で<guimenu>Status (状態)</guimenu>画面に切り替えて、関係するリソースを選択します。<guimenu>Operations (操作)</guimenu>列で、下矢印アイコンをクリックして<guimenu>Recent Events (最近のイベント)</guimenu>を選択します。表示されるダイアログに、リソースに対して実行された最近のアクションが一覧表示されます。障害は赤で表示されます。リソースの詳細を表示するには、<guimenu>Operations (操作)</guimenu>列で虫眼鏡アイコンをクリックします。
   </para>
    <figure>
     <title>Hawk2 - リソース詳細</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="hawk2-rsc-details.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="hawk2-rsc-details.png" width="60%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
  </sect2>
 </sect1>
