<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ha_hawk2_maintenance_i.xml" version="5.0" xml:id="sec.conf.hawk2.maintenance">

 <title>保守モードの使用</title>

    <info>
   <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
    <dm:maintainer/>
    <dm:status>編集</dm:status>
    <dm:deadline/>
    <dm:priority/>
    <dm:translation>yes</dm:translation>
    <dm:languages/>
    <dm:release/>
    <dm:repository/>
   </dm:docmanager>
    </info>
   <para>
   クラスタ設定の変更時、個々のノードに対するソフトウェアパッケージの更新時、または上位製品バージョンへのクラスタのアップグレード時であっても、個々のクラスタコンポーネント上、またはクラスタ全体でテストや保守タスクを実行する必要がある場合があります。
  </para>
  <para>
   それに関して、High Availability Extensionは、次のレベルで<literal>maintenance</literal>オプションを提供しています。
  </para>
  <itemizedlist>
   <listitem>
    <para>
     <xref linkend="sec.conf.hawk2.maint.rsc" xrefstyle="select:title"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="sec.conf.hawk2.maint.nodes" xrefstyle="select:title"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="sec.conf.hawk2.maint.cluster" xrefstyle="select:title"/>
    </para>
   </listitem>
  </itemizedlist>

  <warning>
   <title>データ損失の危険</title>
   <para>クラスタ制御下でサービスを実行しているときにテストまたは保守タスクを実行する必要がある場合は、次のアウトラインに従ってください。</para>
   <orderedlist>
    <listitem>
     <para>手順を開始する前に、個々のリソース、ノード、またはクラスタ全体を保守モードに設定します。これにより、順序正しくリソースを起動できないなどの望ましくない影響、クラスタノード間でCIBが同期されないリスク、またはデータ損失を避けることができます。 </para>
    </listitem>
    <listitem>
     <para>保守タスクまたはテストを実行します。</para>
    </listitem>
    <listitem>
     <para>完了したら、保守モードを解除して、通常のクラスタ操作を開始します。</para>
    </listitem>
   </orderedlist>
  </warning>

  <para>
   保守モード中にリソースおよびクラスタで何が発生するかの詳細については、<xref linkend="sec.ha.config.basics.maint.mode"/>を参照してください。
  </para>
 <sect2 xml:id="sec.conf.hawk2.maint.rsc">
  <title>リソースへの保守モードの適用</title>
  <procedure>
   <step>
    <para>Hawk2にログインします。</para>
    <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
   </step>
   <step>
    <para>
     左のナビゲーションバーで、<guimenu>Status (状態)</guimenu>を選択します。</para>
    </step>
    <step>
     <para>
     <guimenu>Resources (リソース)</guimenu>タブで、保守モードにするリソースを選択します。
    </para>
   </step>
   <step>
    <para><guimenu>Operations (操作)</guimenu>列で、リソースの隣の下矢印アイコンをクリックして<guimenu>Maintenance (保守)</guimenu>を選択します。選択内容を確認します。
    </para>
    <para><guimenu>Status (状態)</guimenu>画面が更新されます。<guimenu>Status (状態)</guimenu>列にリソースの<guimenu>Maintenance Mode (保守モード)</guimenu>アイコンが表示されるようになります。リソースの横の<guimenu>Operations (操作)</guimenu>列も変更されます。</para>
   </step>
   <step>
    <para>リソースの保守タスクを完了します。
    </para>
   </step>
   <step>
    <para>リソースの保守モードを無効にするには、<guimenu>Operations (操作)</guimenu>列に移動して、<guimenu>Disable Maintenance Mode (保守モードを無効にする)</guimenu>をクリックします。
    </para>
    <para>
     リソースは、この時点から再びHigh Availability Extensionソフトウェアによって管理されます。
    </para>
   </step>
  </procedure>
  </sect2>

 <sect2 xml:id="sec.conf.hawk2.maint.nodes">
  <title>ノードへの保守モードの適用</title>
   <para>
    1つのノードを保守モードにする必要がある場合があります。
   </para>
  <procedure>
   <step>
    <para>Hawk2にログインします。</para>
    <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
   </step>
   <step>
    <para>
     左のナビゲーションバーで、<guimenu>Status (状態)</guimenu>を選択肢、<guimenu>ノード</guimenu>タブに切り替えます。</para>
    <para>
     <guimenu>ノード</guimenu>タブで、<guimenu>Maintenance (保守)</guimenu>列にノードの状態が表示されます。赤いアイコンはノードが保守モードであることを意味します。緑のアイコンは、ノードが通常モードで、保守モードに切り替えることが可能であることを意味します。
     </para>
   </step>
   <step>
    <para>保守モードにノードを切り替えるには、リソースの隣の各アイコンをクリックして、選択内容を確認します。 </para>
      <para>
     これにより、<literal>maintenance="true"</literal>というインスタンス属性がノードに追加されます。保このノードでこれまで実行されていたリソースは、<literal>unmanaged</literal>になります。保守モードを終了するまで、このノードに新しいリソースが割り当てられることはありません。
    </para>
   </step>
   <step>
    <para>ノードの保守タスクを完了します。
    </para>
   </step>
   <step>
    <para>保守モードを無効化するには、そのノードの隣の保守アイコンをクリックして選択内容を確認します。 </para>
   </step>
 </procedure>
 </sect2>
 <sect2 xml:id="sec.conf.hawk2.maint.cluster">
  <title>クラスタへの保守モードの適用</title>
  <para>
   クラスタ全体に保守モードを設定または設定解除するには、次の手順に従います。
  </para>
  <procedure>
   <step>
    <para>Hawk2にログインします。</para>
    <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
   </step>
   <step>
    <para>
     左のナビゲーションバーで、<guimenu>クラスタ設定</guimenu>を選択します。
    </para>
    </step>
    <step>
    <para>
     画面の<guimenu>クラスタ設定</guimenu>部分で、空のドロップダウンボックスから<guimenu>maintenance-mode</guimenu>属性を選択し、<guimenu>プラスア</guimenu>イコンをクリックして追加します。
    </para>
   </step>
   <step>
    <para>
     クラスタを保守モードにするには、<guimenu>maintenance-mode</guimenu>の値を<literal>Yes</literal>に設定し、変更内容を適用します。
    </para>
   </step>
   <step>
    <para>クラスタ全体の保守タスクを完了します。
    </para>
   </step>
   <step>
    <para>クラスタの保守モードを無効にするには、<guimenu>maintenance-mode</guimenu>の値を<literal>no</literal>に設定し、変更内容を適用します。
    </para>
    <para>
     この時点から、High Availability Extensionはクラスタ管理をもう一度引き継ぎます。
    </para>
   </step>
  </procedure>
 </sect2>
 </sect1>
