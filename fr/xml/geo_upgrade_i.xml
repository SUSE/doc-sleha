<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="geo_upgrade_i.xml" version="5.0" xml:id="sec.ha.geo.upgrade">
 <title>Mise à niveau vers la dernière version du produit</title>

 <info>
      <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
        <dm:maintainer/>
        <dm:status>modification</dm:status>
        <dm:deadline/>
        <dm:priority/>
        <dm:translation>oui</dm:translation>
        <dm:languages/>
        <dm:release/>
        <dm:repository/>
      </dm:docmanager>
    </info>
    <para> Pour obtenir des instructions générales concernant la procédure de mise à niveau d'une grappe, reportez-vous au manuel <citetitle>SUSE Linux Enterprise High Availability Extension 12 SP2 Administration Guide</citetitle><phrase role="productname"><phrase os="sles"/></phrase><phrase role="productnumber"><phrase os="sles"/></phrase> (Guide d'administration de SUSE Linux Enterprise High Availability Extension 12 SP2), disponible à l'adresse <link xlink:href="http://www.suse.com/documentation/"/>. Le chapitre <citetitle>Upgrading Your Cluster and Updating Software Packages</citetitle> (Mise à niveau de votre grappe et mise à jour des paquetages logiciels) décrit également les préparatifs à effectuer avant de démarrer le processus mise à niveau. </para>

 <table xml:id="table.ha.geo.upgrade.oview">
  <title>Chemins de mise à niveau pris en charge pour SLE HA et SLE HA Geo</title>
  <tgroup cols="3">
   <colspec colnum="1" colname="1" colwidth="25*"/>
   <colspec colnum="2" colname="2" colwidth="22*"/>
   <colspec colnum="3" colname="3" colwidth="53*"/>
   <thead>
    <row>
     <entry>
      <para> Mise à niveau de... vers... </para>
     </entry>
     <entry>
      <para> Chemin de mise à niveau </para>
     </entry>
     <entry>
      <para> Documentation pertinente </para>
     </entry>
    </row>
   </thead>
   <tbody>
    <row>
     <entry>
      <para> SLE HA 11 SP3 vers SLE HA (Geo) 12 </para>
     </entry>
     <entry>
      <para> Migration hors ligne </para>
     </entry>
     <entry>
      <itemizedlist>
       <listitem>
        <para> Système de base : manuel <citetitle>SUSE Linux Enterprise Server 12 Deployment Guide</citetitle> (Guide de déploiement de SUSE Linux Enterprise Server 12), section <citetitle>Updating and Upgrading SUSE Linux Enterprise</citetitle> (Mise à jour et mise à niveau de SUSE Linux Enterprise)
        </para>
       </listitem>
       <listitem>
        <para> SLE HA : manuel <citetitle>SUSE Linux Enterprise High Availability Extension 12 SP1 <phrase role="productname"><phrase os="sles">Administration </phrase></phrase>Guide</citetitle> (Guide d'administration de SUSE Linux Enterprise High Availability Extension 12 SP1), chapitre <citetitle>Upgrading Your Cluster and Updating Software Packages</citetitle> (Mise à niveau de votre grappe et mise à jour des paquetages logiciels), section <citetitle>Offline Migration</citetitle> (Migration hors ligne)
        </para>
       </listitem>
       <listitem>
        <para> SLE HA Geo : <xref linkend="sec.ha.geo.upgrade.offline" xrefstyle="select:title nopage"/>
        </para>
       </listitem>
      </itemizedlist>
     </entry>
    </row>
    <row>
     <entry>
      <para> SLE HA (Geo) 11 SP4 vers SLE HA (Geo) 12 SP1 </para>
     </entry>
     <entry>
      <para> Migration hors ligne </para>
     </entry>
     <entry>
      <itemizedlist>
       <listitem>
        <para> Système de base : manuel <citetitle>SUSE Linux Enterprise Server 12 SP1 Deployment Guide</citetitle> (Guide de déploiement de SUSE Linux Enterprise Server 12), section <citetitle>Updating and Upgrading SUSE Linux Enterprise</citetitle> (Mise à jour et mise à niveau de SUSE Linux Enterprise)
        </para>
       </listitem>
       <listitem>
        <para> SLE HA : manuel <citetitle>SUSE Linux Enterprise High Availability Extension 12 SP1<phrase role="productname"><phrase os="sles">Administration</phrase></phrase> Guide</citetitle> (Guide d'administration de SUSE Linux Enterprise High Availability Extension 12 SP1), chapitre <citetitle>Upgrading Your Cluster and Updating Software Packages</citetitle> (Mise à niveau de votre grappe et mise à jour des paquetages logiciels), section <citetitle>Offline Migration</citetitle> (Migration hors ligne)
        </para>
       </listitem>
       <listitem>
        <para> SLE HA Geo : <xref linkend="sec.ha.geo.upgrade.arbitrators" xrefstyle="select:title nopage"/> </para>
       </listitem>
      </itemizedlist>
     </entry>
    </row>
    <row>
     <entry>
      <para> SLE HA (Geo) 12 vers SLE HA (Geo) 12 SP1 </para>
     </entry>
     <entry>
      <para> Mise à niveau progressive </para>
     </entry>
     <entry>
      <itemizedlist>
       <listitem>
        <para> Système de base : manuel <citetitle>SUSE Linux Enterprise Server 12 SP1 Deployment Guide</citetitle> (Guide de déploiement de SUSE Linux Enterprise Server 12), section <citetitle>Updating and Upgrading SUSE Linux Enterprise</citetitle> (Mise à jour et mise à niveau de SUSE Linux Enterprise)
        </para>
       </listitem>
       <listitem>
        <para> SLE HA : manuel <citetitle>SUSE Linux Enterprise High Availability Extension 12 SP1<phrase role="productname"><phrase os="sles">Administration</phrase></phrase> Guide</citetitle> (Guide d'administration de SUSE Linux Enterprise High Availability Extension 12 SP1), chapitre <citetitle>Upgrading Your Cluster and Updating Software Packages</citetitle> (Mise à niveau de votre grappe et mise à jour des paquetages logiciels), section <citetitle>Rolling Upgrade</citetitle> (Mise à niveau progressive)
        </para>
       </listitem>
       <listitem>
         <para> SLE HA Geo : <xref linkend="sec.ha.geo.upgrade.arbitrators" xrefstyle="select:title nopage"/> </para>
        </listitem>
       </itemizedlist>
     </entry>
    </row>
    <row>
     <entry>
      <para> SLE HA (Geo) 12 SP1 vers SLE HA (Geo) 12 SP2</para>
     </entry>
     <entry>
      <para> Mise à niveau progressive </para>
     </entry>
     <entry>
      <itemizedlist>
       <listitem>
        <para> Système de base : manuel <citetitle>SUSE Linux Enterprise Server 12 SP2 Deployment Guide</citetitle> (Guide de déploiement de SUSE Linux Enterprise Server 12), section <citetitle>Updating and Upgrading SUSE Linux Enterprise</citetitle> (Mise à jour et mise à niveau de SUSE Linux Enterprise)
        </para>
       </listitem>
       <listitem>
        <para> SLE HA : manuel <citetitle>SUSE Linux Enterprise High Availability Extension 12 SP2 <phrase role="productname"><phrase os="sles">Administration</phrase></phrase> Guide</citetitle> (Guide d'administration de SUSE Linux Enterprise High Availability Extension 12 SP1), chapitre <citetitle>Upgrading Your Cluster and Updating Software Packages</citetitle> (Mise à niveau de votre grappe et mise à jour des paquetages logiciels), section <citetitle>Rolling Upgrade</citetitle> (Mise à niveau progressive)
        </para>
       </listitem>
       <listitem>
        <para> SLE HA Geo : <xref linkend="sec.ha.geo.upgrade.arbitrators" xrefstyle="select:title nopage"/> </para>
       </listitem>
       <listitem>
        <para>DRBD 8 vers DRBD 9 : manuel <citetitle>SUSE Linux Enterprise High Availability Extension 12 SP2<phrase role="productname"><phrase os="sles"> </phrase></phrase>Administration Guide</citetitle> (Guide d'administration de SUSE Linux Enterprise High Availability Extension 12 SP2), chapitre <citetitle>DRBD</citetitle>, section <citetitle>Migrating from DRBD 8 to DRBD 9</citetitle> (Migration de DRBD 8 vers DRBD 9)
         </para>
       </listitem>
      </itemizedlist>
     </entry>
    </row>
   </tbody>
  </tgroup>
 </table>

 <sect2 xml:id="sec.ha.geo.upgrade.offline">
  <title>Migration hors ligne</title>
  <para> Cette section s'applique aux scénarios suivants : </para>
  <itemizedlist>
   <listitem>
    <para> Mise à niveau de SLE HA Geo 11 SP3 vers SLE HA Geo 12</para>
   </listitem>
  </itemizedlist>
  <para> La version de booth (v0.1) dans <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> 11 à 11 SP3 était basée sur l'algorithme Paxos. La version de booth (v0.2) dans <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> 11 SP4 et <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> 12 et 12 SPx s'inspire de Raft et n'est pas compatible avec la version v0.1. Par conséquent, il n'est pas possible de procéder à la mise à niveau progressive d'un système exécutant l'ancienne version de booth vers un système exécutant la nouvelle version. Tous les noeuds de grappe doivent être hors ligne et la grappe doit être migrée dans son ensemble, comme décrit dans la <xref linkend="pro.ha.geo.upgrade.offline"/>.</para>
  <para> En raison de la nouvelle fonctionnalité de mutualisation, le nouveau script d'initialisation d'arbitre ne peut pas arrêter ni tester d'état de l'arbitre Paxos v0.1. En cas de mise à niveau vers la version v0.2, l'arbitre, s'il est en cours d'exécution, sera arrêté. L'agent de ressource OCF <literal>ocf:pacemaker:booth-site</literal> est capable d'arrêter et de surveiller le daemon de site booth v0.1. </para>

  <procedure xml:id="pro.ha.geo.upgrade.offline">
   <title>Exécution d'une migration hors ligne à l'échelle de la grappe</title>
   <step>
    <para>Pour procéder à la mise à niveau des noeuds de grappe, suivez les instructions de la section <citetitle>Offline Migration<phrase role="productname"><phrase os="sles"/></phrase></citetitle> (Migration hors ligne) du chapitre <citetitle>Upgrading Your Cluster and Updating Software Packages</citetitle> (Mise à niveau de votre grappe et mise à jour des paquetages logiciels) du manuel <citetitle>SUSE Linux Enterprise High Availability Extension 12 SP1 Administration Guide</citetitle> (Guide d'administration de SUSE Linux Enterprise High Availability Extension 12 SP1). </para>
   </step>
   <step>
    <para> Si vous utilisez des arbitres en dehors des sites de grappe : </para>
    <substeps performance="required">
      <step>
      <para> Mettez à niveau chaque arbitre vers la version souhaitée de SUSE Linux Enterprise Server. Pour obtenir les informations relatives aux différents processus de mise à niveau, reportez-vous au <xref linkend="table.ha.geo.upgrade.oview"/>. </para>
     </step>
     <step>
      <para> Ajoutez l'extension GEO Clustering et installez les paquetages comme décrit dans la <xref linkend="sec.ha.geo.inst.arbitrators"/>. </para>
     </step>
    </substeps>
   </step>
   <step>
    <para> Étant donné que la syntaxe et l'algorithme de consensus de booth ont changé, vous devez mettre à jour les fichiers de configuration de booth pour satisfaire aux exigences les plus récentes. Auparavant, vous pouviez spécifier un délai d'expiration et des pondérations en les ajoutant au nom du ticket avec un point-virgule (<literal>;</literal>) comme séparateur. La nouvelle syntaxe comporte des jetons distincts pour toutes les options de ticket. Pour plus d'informations, reportez-vous à la <xref linkend="sec.ha.geo.booth"/>. Si vous n'avez pas spécifié d'autres délai d'expiration ou pondérations que ceux par défaut et que vous ne souhaitez pas utiliser la fonctionnalité de mutualisation, vous pouvez toujours utiliser l'ancien fichier<filename>/etc/booth/booth.conf</filename>. </para>
   </step>
   <step>
    <para> Synchronisez les fichiers de configuration de booth mis à jour sur l'ensemble des sites de grappe et des arbitres. </para>
   </step>
   <step>
    <para> Démarrez le service booth sur les sites de grappe et les arbitres comme décrit dans la <xref linkend="sec.ha.geo.setup.booth.service"/>. </para>
   </step>
  </procedure>
 </sect2>
 <sect2 xml:id="sec.ha.geo.upgrade.arbitrators">
  <title>Mise à niveau des arbitres</title>
  <para> Cette section s'applique aux scénarios suivants : </para>
  <itemizedlist>
   <listitem>
    <para> Mise à niveau de SLE HA Geo 11 SP4 vers SLE HA Geo 12 SP1 </para>
   </listitem>
   <listitem>
    <para> Mise à niveau de SLE HA Geo 12 vers SLE HA Geo 12 SP1</para>
   </listitem>
   <listitem>
    <para> Mise à niveau de SLE HA Geo 12 SP1 vers SLE HA Geo 12 SP2</para>
   </listitem>
  </itemizedlist>

  <procedure xml:id="pro.ha.geo.upgrade.arbitrators">
   <title>Mise à niveau des arbitres en dehors de la grappe</title>
   <para> Si vous utilisez arbitres en dehors des sites de grappe, procédez comme suit pour chaque arbitre :</para>
  <step>
    <para>Effectuez une mise à niveau vers la version souhaitée de SUSE Linux Enterprise Server. Pour obtenir les informations relatives aux différents processus de mise à niveau, reportez-vous au <xref linkend="table.ha.geo.upgrade.oview"/>.</para>
   </step>
   <step>
    <para> Ajoutez l'extension GEO Clustering et installez les paquetages comme décrit dans la <xref linkend="sec.ha.geo.inst.arbitrators"/>. </para>
   </step>
  </procedure>
 </sect2>
</sect1>
